# 課題 1

- バックエンドでDBへのクエリを送る際に必ずtarent_idでのWhereを必須とするようなモジュールを作っておく

# 課題 2

## テナント毎にデータベースを分割する
### メリット
- 誤って他のテナントのデータを見てしまうエラーを防ぐことができる
- 一部のテナントに重大な問題が発生しても、他のテナントには影響しない
### デメリット
- スケーリングによるコストが大きい
- 全テナントをそれぞれデプロイしないといけない
- 全テナントで共通の問題が発覚しても、同等の処理をすべてで行う必要があり、処理の共通化がしにくい
## テナント毎にスキーマを分割する
### メリット
- コストがかからない
- 全テナント共通の処理を書くことができる
### デメリット
- 他テナントのデータにアクセスしてしまうセキュリティ面が比較的低い
## すべてのテナントで同じスキーマを使う
### メリット
- コストがかからない
- すべて共通処理が書けるので一度設計が行われるとその後のメンテナンスが楽
### デメリット
- 他テナントのデータにアクセスしてしまうセキュリティ面が比較的最も低い
## RLS と、これを活用したマルチテナントアーキテクチャの実装方法
- ENABLE ROW LEVEL SECURITY を適用すことで行レベルでユーザーのアクセスを制御可能になる
- 作成したテーブルに対して、CREATE POLICY で詳細をつめる
- 例えば今回だと、テナント ID に一致する行にアクセスでき、かつ自分のアカウントのテナント ID の行のみアクセスできるポリシー
- コネクション取得時に必要な ID など検索につかうものをセットする